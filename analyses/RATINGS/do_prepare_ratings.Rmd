---
title: "Prepare ratings"
output: html_notebook
---

Preparing the ratings, from the files already preprocessed by Cas, copied from `/data00/CasfMRI/Master_logfiles/Master_log_RSA_rating_allmodels` into `$PWD/from_Cas`

**IMPORTANT**: The files provided by Cas have no header, therefore they should be read accordingly

```{r}
library(tidyverse)

dest="/data00/leonardo/RSA/analyses/RATINGS"
orig=paste0(dest,"/from_Cas")

```


# Arousal ratings
```{r}
filename_orig <- "sorted_arousal_ratings.csv"
arousal_orig <- read_csv(paste0(orig,"/",filename_orig), col_names = FALSE)

colnames(arousal_orig) <- c("sub","run","movie_number","onset_sec","unidentified","rating")

arousal_orig

# # checking that the numbers are correct
# nsubs = 26
# nruns = 8
# nmovies = 56
# nrow(arousal_orig) / nruns / nsubs == nmovies

arousal_ratings <- arousal_orig %>% 
  select(!unidentified) %>% 
  mutate(onset_sec = round(onset_sec,2))

arousal_ratings

write_csv(arousal_ratings, paste0(dest,"/arousal_ratings.csv"))

# df <- read_csv(paste0(dest,"/arousal_ratings.csv"))
```


# Valence ratings - PROBLEM HERE

It looks like the Valence rating does not contain two columns of the same file, but rather the arousal column and the valence column.

In other words, the ratings column of `sorted_arousal_ratings.csv` is the first column of `sorted_valence_ratings.csv`

Indeed the following two files are identical:
`diff sorted_valence_ratings.csv sorted_valence_arousal_ratings.csv`


```{r}
arousal_orig %>% 
  mutate(r_arousal = rating) %>% select(r_arousal)

valence_orig %>% 
  mutate(r1_valence = rating_1, r2_valence = rating_2) %>% 
  select(r1_valence, r2_valence)

plot(arousal_orig$rating, valence_orig$rating_1)

sum(arousal_orig$rating - valence_orig$rating_1)

```

For the time being, I will assume that the rating_2 in `sorted_valence_rating` is actually the valence rating

```{r}
filename_orig <- "sorted_valence_ratings.csv"
valence_orig <- read_csv(paste0(orig,"/",filename_orig), col_names = FALSE)

colnames(valence_orig) <- c("sub","run","movie_number","onset_sec","unidentified","arousal_rating","valence_rating")

valence_orig

valence_ratings <- valence_orig %>%
  select(!arousal_rating) %>% 
  rename(rating = valence_rating) %>% 
  select(!unidentified) %>% 
  mutate(onset_sec = round(onset_sec,2))

valence_ratings

write_csv(valence_ratings, paste0(dest,"/valence_ratings.csv"))

```






# Emotions ratings
```{r}
filename_orig <- "sorted_emotion_ratings.csv"
emotion_orig <- read_csv(paste0(orig,"/",filename_orig), col_names = FALSE)

emotion_orig

colnames(emotion_orig) <- c(
  "sub","run","movie_number","onset_sec","unidentified",
  "r_anger", "r_disgust", "r_fear", "r_happy", "r_pain", "r_sad"
)

emotion_ratings <- emotion_orig %>% 
  select(!unidentified) %>% 
  mutate(onset_sec = round(onset_sec,2))

emotion_ratings

write_csv(emotion_ratings, paste0(dest,"/emotion_ratings.csv"))
```




